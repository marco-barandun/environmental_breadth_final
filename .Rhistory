coord_cartesian(ylim = c(0, 7.5), xlim = c(0, 1))
S4A
S4B_data <- niche_data %>% filter(growthform == "herb") %>% filter(is.na(zone_s))
S4B_breaks <- quantile(S4B_data[["e_breadth"]], probs = seq(0, 1, by = 0.05), na.rm = TRUE)
S4B <- ggplot(data = S4B_data,
aes(x = e_breadth, y = lat_range_sd_n)) +
geom_density_2d_filled(bins = 20, show.legend = FALSE) +
stat_summary_bin(breaks = S4B_breaks,
fun = mean,
fun.min = function(x) mean(x)-sd(x)/sqrt(length(x)),
fun.max = function(x) mean(x)+sd(x)/sqrt(length(x)),
color = "azure4") +
geom_smooth(
aes(linetype = .data[["zone_n"]]),
color = "black",
method = "lm",
na.rm = TRUE,
show.legend = FALSE) +
ggtitle("Northern hemisphere, herb") +
xlab("Latitudinal median") +
ylab("Latitudinal range (SD)") +
annotate("text", x = 0.15, y = 7, size = 5,
label = paste("β (tropical) =\n",
allres_eblr %>%
filter(hemisphere == "North") %>%
filter(growthform == "herb") %>%
filter(zone == "tropical") %>%
.$valse)) +
annotate("text", x = 0.55, y = 7, size = 5,
label = paste("β (else) =\n",
allres_eblr %>%
filter(hemisphere == "North") %>%
filter(growthform == "herb") %>%
filter(zone == "else") %>%
.$valse)) +
theme_classic() +
theme(text = element_text(size = 17)) +
scale_fill_manual(values = mycolors) +
coord_cartesian(ylim = c(0, 7.5), xlim = c(0, 70))
S4B
S4B <- ggplot(data = S4B_data,
aes(x = e_breadth, y = lat_range_sd_n)) +
geom_density_2d_filled(bins = 20, show.legend = FALSE) +
stat_summary_bin(breaks = S4B_breaks,
fun = mean,
fun.min = function(x) mean(x)-sd(x)/sqrt(length(x)),
fun.max = function(x) mean(x)+sd(x)/sqrt(length(x)),
color = "azure4") +
geom_smooth(
aes(linetype = .data[["zone_n"]]),
color = "black",
method = "lm",
na.rm = TRUE,
show.legend = FALSE) +
ggtitle("Northern hemisphere, herb") +
xlab("Environmental breadth") +
ylab("Latitudinal range (SD)") +
annotate("text", x = 0.15, y = 7, size = 5,
label = paste("β (tropical) =\n",
allres_eblr %>%
filter(hemisphere == "North") %>%
filter(growthform == "herb") %>%
filter(zone == "tropical") %>%
.$valse)) +
annotate("text", x = 0.55, y = 7, size = 5,
label = paste("β (else) =\n",
allres_eblr %>%
filter(hemisphere == "North") %>%
filter(growthform == "herb") %>%
filter(zone == "else") %>%
.$valse)) +
theme_classic() +
theme(text = element_text(size = 17)) +
scale_fill_manual(values = mycolors) +
coord_cartesian(ylim = c(0, 7.5))
S4B
S4C_data <- niche_data %>% filter(growthform == "tree") %>% filter(is.na(zone_n))
S4C_breaks <- quantile(S4C_data[["e_breadth"]], probs = seq(0, 1, by = 0.05), na.rm = TRUE)
S4C <- ggplot(data = S4C_data,
aes(x = e_breadth, y = lat_range_sd_s)) +
geom_density_2d_filled(bins = 20, show.legend = FALSE) +
stat_summary_bin(breaks = S4C_breaks,
fun = mean,
fun.min = function(x) mean(x)-sd(x)/sqrt(length(x)),
fun.max = function(x) mean(x)+sd(x)/sqrt(length(x)),
color = "azure4") +
geom_smooth(
aes(linetype = .data[["zone_s"]]),
color = "black",
method = "lm",
na.rm = TRUE,
show.legend = FALSE) +
ggtitle("Southern hemisphere, tree") +
xlab("Environmental breadth") +
ylab("Latitudinal range (SD)") +
annotate("text", x = 0.15, y = 7, size = 5,
label = paste("β (tropical) =\n",
allres_eblr %>%
filter(hemisphere == "South") %>%
filter(growthform == "tree") %>%
filter(zone == "tropical") %>%
.$valse)) +
annotate("text", x = 0.55, y = 7, size = 5,
label = paste("β (else) =\n",
allres_eblr %>%
filter(hemisphere == "South") %>%
filter(growthform == "tree") %>%
filter(zone == "else") %>%
.$valse)) +
theme_classic() +
theme(text = element_text(size = 17)) +
scale_fill_manual(values = mycolors) +
coord_cartesian(ylim = c(0, 7.5))
S4C
S4D_data <- niche_data %>% filter(growthform == "herb") %>% filter(is.na(zone_n))
S4D_breaks <- quantile(S4D_data[["e_breadth"]], probs = seq(0, 1, by = 0.05), na.rm = TRUE)
S4D <- ggplot(data = S4D_data,
aes(x = e_breadth, y = lat_range_sd_s)) +
geom_density_2d_filled(bins = 20, show.legend = FALSE) +
stat_summary_bin(breaks = S4D_breaks,
fun = mean,
fun.min = function(x) mean(x)-sd(x)/sqrt(length(x)),
fun.max = function(x) mean(x)+sd(x)/sqrt(length(x)),
color = "azure4") +
geom_smooth(
aes(linetype = .data[["zone_s"]]),
color = "black",
method = "lm",
na.rm = TRUE,
show.legend = FALSE) +
ggtitle("Southern hemisphere, herb") +
xlab("Environmental breadth") +
ylab("Latitudinal range (SD)") +
annotate("text", x = 0.15, y = 7, size = 5,
label = paste("β (tropical) =\n",
allres_eblr %>%
filter(hemisphere == "South") %>%
filter(growthform == "herb") %>%
filter(zone == "tropical") %>%
.$valse)) +
annotate("text", x = 0.55, y = 7, size = 5,
label = paste("β (else) =\n",
allres_eblr %>%
filter(hemisphere == "South") %>%
filter(growthform == "herb") %>%
filter(zone == "else") %>%
.$valse)) +
theme_classic() +
theme(text = element_text(size = 17)) +
scale_fill_manual(values = mycolors) +
coord_cartesian(ylim = c(0, 7.5))
S4D
S4 <- cowplot::plot_grid(S4A,
S4B,
S4C,
S4D,
rel_widths = c(1.3, 1, 1,
1.3, 1, 1),
ncol = 2, byrow = FALSE,
labels = c("A", "C",
"B", "D"),
label_size = 20)
S4
ggsave("./tmp/new_figure_S4.jpg",
width = 4000, height = 3000, units = "px")
S5A_data <- niche_data %>% filter(growthform == "tree") %>% filter(is.na(zone_s))
S5A_breaks <- quantile(S5A_data[["lat_median_n"]], probs = seq(0, 1, by = 0.05), na.rm = TRUE)
S5A <- ggplot(data = S5A_data,
aes(x = lat_median_n, y = e_breadth)) +
geom_density_2d_filled(bins = 20, show.legend = FALSE) +
stat_summary_bin(breaks = S5A_breaks,
fun = mean,
fun.min = function(x) mean(x)-sd(x)/sqrt(length(x)),
fun.max = function(x) mean(x)+sd(x)/sqrt(length(x)),
color = "azure4") +
geom_smooth(
aes(linetype = .data[["zone_n"]]),
color = "black",
method = "lm",
na.rm = TRUE,
show.legend = FALSE) +
ggtitle("Northern hemisphere, tree") +
xlab("Latitudinal median") +
ylab("Environmental breadth") +
annotate("text", x = 10, y = 7, size = 5,
label = paste("β (tropical) =\n",
allres_eblr %>%
filter(hemisphere == "North") %>%
filter(growthform == "tree") %>%
filter(zone == "tropical") %>%
.$valse)) +
annotate("text", x = 45, y = 7, size = 5,
label = paste("β (else) =\n",
allres_eblr %>%
filter(hemisphere == "North") %>%
filter(growthform == "tree") %>%
filter(zone == "else") %>%
.$valse)) +
theme_classic() +
theme(text = element_text(size = 17)) +
scale_fill_manual(values = mycolors) +
coord_cartesian(xlim = c(0, 70))
S5A <- ggplot(data = S5A_data,
aes(x = lat_median_n, y = e_breadth)) +
geom_density_2d_filled(bins = 20, show.legend = FALSE) +
stat_summary_bin(breaks = S5A_breaks,
fun = mean,
fun.min = function(x) mean(x)-sd(x)/sqrt(length(x)),
fun.max = function(x) mean(x)+sd(x)/sqrt(length(x)),
color = "azure4") +
geom_smooth(
aes(linetype = .data[["zone_n"]]),
color = "black",
method = "lm",
na.rm = TRUE,
show.legend = FALSE) +
ggtitle("Northern hemisphere, tree") +
xlab("Latitudinal median") +
ylab("Environmental breadth") +
annotate("text", x = 10, y = 7, size = 5,
label = paste("β (tropical) =\n",
allres_lmeb %>%
filter(hemisphere == "North") %>%
filter(growthform == "tree") %>%
filter(zone == "tropical") %>%
.$valse)) +
annotate("text", x = 45, y = 7, size = 5,
label = paste("β (else) =\n",
allres_lmeb %>%
filter(hemisphere == "North") %>%
filter(growthform == "tree") %>%
filter(zone == "else") %>%
.$valse)) +
theme_classic() +
theme(text = element_text(size = 17)) +
scale_fill_manual(values = mycolors) +
coord_cartesian(xlim = c(0, 70))
S5A
S5A <- ggplot(data = S5A_data,
aes(x = lat_median_n, y = e_breadth)) +
geom_density_2d_filled(bins = 20, show.legend = FALSE) +
stat_summary_bin(breaks = S5A_breaks,
fun = mean,
fun.min = function(x) mean(x)-sd(x)/sqrt(length(x)),
fun.max = function(x) mean(x)+sd(x)/sqrt(length(x)),
color = "azure4") +
geom_smooth(
aes(linetype = .data[["zone_n"]]),
color = "black",
method = "lm",
na.rm = TRUE,
show.legend = FALSE) +
ggtitle("Northern hemisphere, tree") +
xlab("Latitudinal median") +
ylab("Environmental breadth") +
annotate("text", x = 10, y = 0.75, size = 5,
label = paste("β (tropical) =\n",
allres_lmeb %>%
filter(hemisphere == "North") %>%
filter(growthform == "tree") %>%
filter(zone == "tropical") %>%
.$valse)) +
annotate("text", x = 45, y = 0.75, size = 5,
label = paste("β (else) =\n",
allres_lmeb %>%
filter(hemisphere == "North") %>%
filter(growthform == "tree") %>%
filter(zone == "else") %>%
.$valse)) +
theme_classic() +
theme(text = element_text(size = 17)) +
scale_fill_manual(values = mycolors) +
coord_cartesian(ylim = c(0, 0.8), xlim = c(0, 70))
S5A
S5B_data <- niche_data %>% filter(growthform == "herb") %>% filter(is.na(zone_s))
S5B_breaks <- quantile(S5B_data[["e_breadth"]], probs = seq(0, 1, by = 0.05), na.rm = TRUE)
S5B <- ggplot(data = S5B_data,
aes(x = e_breadth, y = lat_range_sd_n)) +
geom_density_2d_filled(bins = 20, show.legend = FALSE) +
stat_summary_bin(breaks = S5B_breaks,
fun = mean,
fun.min = function(x) mean(x)-sd(x)/sqrt(length(x)),
fun.max = function(x) mean(x)+sd(x)/sqrt(length(x)),
color = "azure4") +
geom_smooth(
aes(linetype = .data[["zone_n"]]),
color = "black",
method = "lm",
na.rm = TRUE,
show.legend = FALSE) +
ggtitle("Northern hemisphere, herb") +
xlab("Latitudinal median") +
ylab("Environmental breadth") +
annotate("text", x = 10, y = 0.75, size = 5,
label = paste("β (tropical) =\n",
allres_eblr %>%
filter(hemisphere == "North") %>%
filter(growthform == "herb") %>%
filter(zone == "tropical") %>%
.$valse)) +
annotate("text", x = 45, y = 0.75, size = 5,
label = paste("β (else) =\n",
allres_eblr %>%
filter(hemisphere == "North") %>%
filter(growthform == "herb") %>%
filter(zone == "else") %>%
.$valse)) +
theme_classic() +
theme(text = element_text(size = 17)) +
scale_fill_manual(values = mycolors) +
coord_cartesian(ylim = c(0, 0.8), xlim = c(0, 70))
S5B
S5B_data <- niche_data %>% filter(growthform == "herb") %>% filter(is.na(zone_s))
S5B_breaks <- quantile(S5B_data[["lat_median_n"]], probs = seq(0, 1, by = 0.05), na.rm = TRUE)
S5B <- ggplot(data = S5B_data,
aes(x = lat_median_n, y = e_breadth)) +
geom_density_2d_filled(bins = 20, show.legend = FALSE) +
stat_summary_bin(breaks = S5B_breaks,
fun = mean,
fun.min = function(x) mean(x)-sd(x)/sqrt(length(x)),
fun.max = function(x) mean(x)+sd(x)/sqrt(length(x)),
color = "azure4") +
geom_smooth(
aes(linetype = .data[["zone_n"]]),
color = "black",
method = "lm",
na.rm = TRUE,
show.legend = FALSE) +
ggtitle("Northern hemisphere, herb") +
xlab("Latitudinal median") +
ylab("Environmental breadth") +
annotate("text", x = 10, y = 0.75, size = 5,
label = paste("β (tropical) =\n",
allres_eblr %>%
filter(hemisphere == "North") %>%
filter(growthform == "herb") %>%
filter(zone == "tropical") %>%
.$valse)) +
annotate("text", x = 45, y = 0.75, size = 5,
label = paste("β (else) =\n",
allres_eblr %>%
filter(hemisphere == "North") %>%
filter(growthform == "herb") %>%
filter(zone == "else") %>%
.$valse)) +
theme_classic() +
theme(text = element_text(size = 17)) +
scale_fill_manual(values = mycolors) +
coord_cartesian(ylim = c(0, 0.8), xlim = c(0, 70))
S5B
S5B <- ggplot(data = S5B_data,
aes(x = lat_median_n, y = e_breadth)) +
geom_density_2d_filled(bins = 20, show.legend = FALSE) +
stat_summary_bin(breaks = S5B_breaks,
fun = mean,
fun.min = function(x) mean(x)-sd(x)/sqrt(length(x)),
fun.max = function(x) mean(x)+sd(x)/sqrt(length(x)),
color = "azure4") +
geom_smooth(
aes(linetype = .data[["zone_n"]]),
color = "black",
method = "lm",
na.rm = TRUE,
show.legend = FALSE) +
ggtitle("Northern hemisphere, herb") +
xlab("Latitudinal median") +
ylab("Environmental breadth") +
annotate("text", x = 10, y = 0.75, size = 5,
label = paste("β (tropical) =\n",
allres_lmeb %>%
filter(hemisphere == "North") %>%
filter(growthform == "herb") %>%
filter(zone == "tropical") %>%
.$valse)) +
annotate("text", x = 45, y = 0.75, size = 5,
label = paste("β (else) =\n",
allres_lmeb %>%
filter(hemisphere == "North") %>%
filter(growthform == "herb") %>%
filter(zone == "else") %>%
.$valse)) +
theme_classic() +
theme(text = element_text(size = 17)) +
scale_fill_manual(values = mycolors) +
coord_cartesian(ylim = c(0, 0.8), xlim = c(0, 70))
S5B
S5C_data <- niche_data %>% filter(growthform == "tree") %>% filter(is.na(zone_n))
S5C_breaks <- quantile(S5C_data[["lat_median_s"]], probs = seq(0, 1, by = 0.05), na.rm = TRUE)
S5C <- ggplot(data = S5C_data,
aes(x = lat_median_s, y = e_breadth)) +
geom_density_2d_filled(bins = 20, show.legend = FALSE) +
stat_summary_bin(breaks = S5C_breaks,
fun = mean,
fun.min = function(x) mean(x)-sd(x)/sqrt(length(x)),
fun.max = function(x) mean(x)+sd(x)/sqrt(length(x)),
color = "azure4") +
geom_smooth(
aes(linetype = .data[["zone_s"]]),
color = "black",
method = "lm",
na.rm = TRUE,
show.legend = FALSE) +
ggtitle("Southern hemisphere, tree") +
xlab("Latitudinal median") +
ylab("Environmental breadth") +
annotate("text", x = 10, y = 0.75, size = 5,
label = paste("β (tropical) =\n",
allres_lmeb %>%
filter(hemisphere == "South") %>%
filter(growthform == "tree") %>%
filter(zone == "tropical") %>%
.$valse)) +
annotate("text", x = 45, y = 0.75, size = 5,
label = paste("β (else) =\n",
allres_lmeb %>%
filter(hemisphere == "South") %>%
filter(growthform == "tree") %>%
filter(zone == "else") %>%
.$valse)) +
theme_classic() +
theme(text = element_text(size = 17)) +
scale_fill_manual(values = mycolors) +
S5C
S5C_data <- niche_data %>% filter(growthform == "tree") %>% filter(is.na(zone_n))
S5C_breaks <- quantile(S5C_data[["lat_median_s"]], probs = seq(0, 1, by = 0.05), na.rm = TRUE)
S5C <- ggplot(data = S5C_data,
aes(x = lat_median_s, y = e_breadth)) +
geom_density_2d_filled(bins = 20, show.legend = FALSE) +
stat_summary_bin(breaks = S5C_breaks,
fun = mean,
fun.min = function(x) mean(x)-sd(x)/sqrt(length(x)),
fun.max = function(x) mean(x)+sd(x)/sqrt(length(x)),
color = "azure4") +
geom_smooth(
aes(linetype = .data[["zone_s"]]),
color = "black",
method = "lm",
na.rm = TRUE,
show.legend = FALSE) +
ggtitle("Southern hemisphere, tree") +
xlab("Latitudinal median") +
ylab("Environmental breadth") +
annotate("text", x = 10, y = 0.75, size = 5,
label = paste("β (tropical) =\n",
allres_lmeb %>%
filter(hemisphere == "South") %>%
filter(growthform == "tree") %>%
filter(zone == "tropical") %>%
.$valse)) +
annotate("text", x = 45, y = 0.75, size = 5,
label = paste("β (else) =\n",
allres_lmeb %>%
filter(hemisphere == "South") %>%
filter(growthform == "tree") %>%
filter(zone == "else") %>%
.$valse)) +
theme_classic() +
theme(text = element_text(size = 17)) +
scale_fill_manual(values = mycolors) +
coord_cartesian(ylim = c(0, 0.8), xlim = c(0, 70))
S5C
S5D_data <- niche_data %>% filter(growthform == "herb") %>% filter(is.na(zone_n))
S5D_breaks <- quantile(S5D_data[["lat_median_s"]], probs = seq(0, 1, by = 0.05), na.rm = TRUE)
S5D <- ggplot(data = S5D_data,
aes(x = lat_median_s, y = e_breadth)) +
geom_density_2d_filled(bins = 20, show.legend = FALSE) +
stat_summary_bin(breaks = S5D_breaks,
fun = mean,
fun.min = function(x) mean(x)-sd(x)/sqrt(length(x)),
fun.max = function(x) mean(x)+sd(x)/sqrt(length(x)),
color = "azure4") +
geom_smooth(
aes(linetype = .data[["zone_s"]]),
color = "black",
method = "lm",
na.rm = TRUE,
show.legend = FALSE) +
ggtitle("Southern hemisphere, herb") +
xlab("Latitudinal median") +
ylab("Environmental breadth") +
annotate("text", x = 10, y = 0.75, size = 5,
label = paste("β (tropical) =\n",
allres_lmeb %>%
filter(hemisphere == "South") %>%
filter(growthform == "herb") %>%
filter(zone == "tropical") %>%
.$valse)) +
annotate("text", x = 45, y = 0.75, size = 5,
label = paste("β (else) =\n",
allres_lmeb %>%
filter(hemisphere == "South") %>%
filter(growthform == "herb") %>%
filter(zone == "else") %>%
.$valse)) +
theme_classic() +
theme(text = element_text(size = 17)) +
scale_fill_manual(values = mycolors) +
coord_cartesian(ylim = c(0, 0.8), xlim = c(0, 70))
S5D
S5 <- cowplot::plot_grid(S5A,
S5B,
S5C,
S5D,
rel_widths = c(1.3, 1, 1,
1.3, 1, 1),
ncol = 2, byrow = FALSE,
labels = c("A", "C",
"B", "D"),
label_size = 20)
S5
ggsave("./tmp/new_figure_S5.jpg",
width = 4000, height = 3000, units = "px")
